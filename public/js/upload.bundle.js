(()=>{"use strict";const e={getWallet:async function(){try{console.log("Loading wallet from environment variable");const e=atob("eyJrdHkiOiJSU0EiLCJuIjoiMFVkOWdXOWNfU05SZTVIa2tPdU1lclpkWk9FUjNjdkstbXRibmZENDBERjZwTWtYYnlkSWN4dUVJTUFVaFowNE9Rc2xSWG9kTUlyalg2U2hzQkl1SUhoeTRVRmRVejVIWDh2M01aVjRsVDE2Z2puQzViUWU5d2E5NmNYbUJ5MU1CMWJVQ3dkZjFfZU1RQWJaM25iY2xoclVQMDZRbExXN2JDS3d4Y245Sk5lRzNsSGtFMjBmTzF4Zkp1WTBGNlRyLVdaZkhLcU5MSVg1a3djYldiS0VfWUlDdVAxWmxBa2NnVTRaVmxON0lzRGs3WGkzWWpGZXJWcUs4b1k0ejBsV0k4SkdyTlVROWlGeFRDVHFMNEJGNUl1RnY0N2RJNjRTSVJTbzBLaE9fZ1NwdWFrRzdXbi1pN1JPNk80djFJMUZvVmZDM0g4SVNuRm1YcmhaWlVRdmx0VHdGX3pkS1NVZW5Mbzdhc1gtckprRnRWaWhxbjVKV2xXN05oQ013Y1JfZ2tJYlAzYnR0NjYwWS05N0lIRlhYanowZUJRMDFGRTJBaTdDVjl2U3l0Wk5iZ2U0OG5IakljcnctaFZGSW5uR0NXeEFLSmFQa3F3aFRuZEtObXZQa2N0V0s5c01JSWt6TWJ3Y3ZkNjFpRHFabkJxSGZReXgyazh4Q25nX3FwOVY4bk1WRHhvak1vaEo0WmxqZnd6c29QUWREenhZdGtxOENsQkJjTTVuUXdSY0xndUN4OVVPZndrbkdLRnowZUtETGhZVGF2LWFIQ3hrT2tmUmpDNy04T2VocS1GeVJzbWp4VDBqdEtFeVR5MkRqZk40bWRjUEwxNlA5ZnFHSWZhblhmR0QyaktQenJKZDRFbEdsWDBXY2RQcU5KYTQ1TF9ieXF2RjFoRE96YmMiLCJlIjoiQVFBQiIsImQiOiJDLTRmWVhtUHUzNV83cU5xZkRoeFVhMkR0WFJfS0QydDNJaXlPRmE4V0dINXM5c2kwdHRTYmYxcmt0SmdXUjJWVHVzcnZNSXhWOHNUR3lpdmJ2SWFYdzktdlFpVTRXSHpmNnFJOVBLb1pSbVVHa2hncS1lUXZGUk9EejJRMTJmbHBhVjFnUXR5azBVeFlaVUNab1F3SHY1NGl3TlhpcUt4aElDVnd6QzRsWmtUdnlpNzc3LVF3RG1MMHhQY2RGeWFkeVUyMXRPQ0tMLWFjcDg5Ri1mdFhPWkVjWGNfM0FpSTczWWNTNmVHcFh5SmtHQUpWRGVzUmdXYlZpZ0FwUkJ4TUtpcWpyLTJyOUZJUENiLWtxYWxWVm4temVTX0JvR3QxdVR1bXJaOWlrMkp2Mk83V1YxcGZWMVNBa1ZSeExRb19BR2N3aVVidS1LckMwdEhEVmJOdjVrRlNtUGZOVndYWW4tZ0d0SGNINWJBMDBHVFY3cWNwMEs2N0lWS3doOEItUm9vanlWWWhSMmNtXzVkZlZOUVFsa19qQTU5aEp1bkRzc2NIaFJLLTQyOWlsYW01cWhaVjZWNWNxbm5ZU0xRdG1jdEVpVDhZVVRFa2k5WEswck5wUDB3TjAwNGowNDlDYjl2eF9pVHcwRHgybjAzT2s3dWtINEJfc0w1a1VnbklUaTcyRGNWWnNjcmN5RFVwWjg5dG5pQWlZMWJ6OUJQZEx0VnlLbjNWT2xXMVhJSWR3OXllRFVJdW1aQUNLRnBGcF9wRFBTcHBOZGpkUVdwT3JGQjZJTzJWX2haNHFocHVQRzRJWnVHMjM1TXRpZFFENmxYUkMyR2tYckhDcU1sRWUzb1MwWTNzUDRwbUthVEVfSk8tRUxqQlp6QnVWVjFGT3FfRUNrdWw0RSIsInAiOiI5UEU5TEpsb0ZUWko5QzBEQXFaSGFXTkhtMVhPSmxkbW41RGVtNmwybjUxRTlkeC1LWmFiQzNhQ1NOTkdEMzNpeWxEOUdhR2NjdWlNUDNQWDAtUG5oU0VOblhoNVY3TXV1NkYzcGUtcGMxd2xZaWJteUw2N3RMeVhjbXhnU25COUFyWW5xeDAwZWYwakY0UzNfcU11UXlYcXoxRnRNR0tzaGx2Ny1mVGtEZjhZSFdaUVFYZVZlV0xRUmJreERrVTAxR1M2blVjWEFxMlYxQ1pLZHBXVXAwZDNxNElOMVdOVHN6UGNYdGVUWGVBMTlCR3MwU1oyVnhKRV92LUticEJmbVk2NGo4eFg2MWotYTlXSHpUX0YwdlNzdElYcXpuOFV5U0d2SHJoR0RNX3hWZEgyVjlBc1NJdlZETTRNVXhsZEVYQ29vMzZhTjRRLXdwUjNsdldNVHciLCJxIjoiMnJvWk9mUXZCU3FfN2VVZjBSOUpDQ01jX2hQYll5Z1g3d2JDNHBMQVZXUW1paE5jQ0VyaUhFVnlLcXBYVC16VUprX0xKY1g4bGJFUDB5Wm15VjR0MGV1dm5TWEw3Y2prVnd3UzdMb2hLbmVEQk8xUDZtd1lId0twbUR2eFozbG9kZ3Fha0d3bEp3aVBLSm0xUks1Ui1ETEZvLVlQY0VJUDNwYkpGUVRkZVREdkxNVW41WEVhMDR2cGtJZFR3aUF0d1BQd195NVNRUHJzV0UxTzdPeWVhNkFJaXVkdmM4Y21iNmFIYmt4SllmdkZvY0ZGdlJNUXFGbFVsMVJ6RGZWTVpibFlSZ0plaWg3VVNVaDNJVFY3Uzc1RU1ORlFwb01lRjdXYnVfbFhwdnZOLXUwRE0tWVBwZkZmR0pWcXBTRVZ1cE5HNVFVX29BVzBmTzItWkFIR0dRIiwiZHAiOiJCU3MtRmozYWczQVUyWEZGdWYyV1RqUUpJODhJdmFoa2d3T0VueFpSYVliaEdLc2hnbkVxTG5DLXlSaWtSdGxxT3NqQXZwUzVmM2RHMW1QMGJ3VkZNbnNERllxZ1RPaDhHUHVNVWRVZjUwNVBmNlhBZ3dYN1loSUV4Q1pqVmM3UDVJbkJob3ZrT3ByTDdjZ2dOZUJ0cm44VFdIS29jamZ5MmhjQTEwS0N1WVRqbG1NOVdGUlV0QzRRcFJnR1hfMjM0cS1KZko0dWJ5RUlvMlIzZDg4cVJ1bHNMaE5kaFY1R091YmlSS0laLXdZclBVNU9May00ZVpmcUd0TjdzVi1jbE5uOUxST3IyMHlTZWVZVXFwRW85STJ6UTBfOEo0VnBBLUdSRjMzZUJKRXl6NVBSdGdLdm5JeE8zNmxOZTBkeXZsWjVTSkg0WVNtS1JZTHFqeVg1WXciLCJkcSI6ImdHbDVuZmlxRWxLQzA5d016ZTJjSnRiV2txUjl6TDBoTUFlOEt1RVZZZ3ltUTdJUi1oeGNtMVI2TG1wTFVIVXVLRF80ZUhqQVRmSGg1SWxMRnpYZm1MclNJMlNwVVRUOE9jNnczYUo1RGtHVF9qU0ZFb19icVhrYXNIR2d6S3NPbFI2c2w5V21Da0NRSzdueUhoeHBxMW5EaHZIdVptMmllM196RmhBQkpzRl82YnptSzJJMzZiTGVzU2VDR1JwalFrRDFZQnVGMXZoNkFXMkJ4TDgyVXVGbG9vYzFlN2VUN1VETGlnbm5tMHNCUUhJRHkzbUI4aFJnQVdobkUtN0xwMzBsUWhUcUJCVU5kT2pDYUJES0RqSHFQdTdrZHAzTDhRZUNJdDNFaEJpWldaUUVxVmVNSUZTUkRCSE14cDJoOENPX0gzM3hXTFdBdlVlbTIzZmZJUSIsInFpIjoiYms2c0hqQXRuTFJ6OFlVSmtxelpqLUJkdlJGM1NRQzc2ekRmWWlLU1VFaUpWbnRZYlN1QjVLTzNnMzVCcEhzazNnb0Nxdlh3ZW5VcDBISGJ3R2NScnQ4U3A3SDVfV2xSelhxVENoRjNmdFpNdF82UkxISWpobG5nNzhUb1NrSjU3Q2RrT3hyem84cEwzUldiZGJpczRSVExEdjZacVNDY05oNVN6bGF5Y3N3U1JZYm1ucHIwbjRFNklGUlhlcnk1Zy1UZDdhWHNJZFhPZXd1OEpiVTVfYkMxZE5GQXlMSnRiQ3hMTnpUU1VfbXUwNVFXRm9kYTdfX3dJX2k0c3h3N1R5OUREZUFia0wtQjhQWDJ0Tk5rNlhOOVBSeWQtdFZtSmZvSk1QUTZHWElFMXFrajZfRVpsUlVlRFZEdzJ1MVgwVHp2N1o2aUlQM0pwd25tTzVPczlnIn0="),t=JSON.parse(e);return console.log("âœ“ Successfully loaded wallet from environment variable"),t.kty&&t.n&&t.e&&t.d||console.error("WARNING: Wallet loaded from environment variable appears incomplete"),t}catch(e){throw console.error("ERROR: Failed to load wallet from environment variable:",e),new Error(`Wallet loading failed: ${e.message}`)}},walletToBase64:function(e){try{const t=JSON.stringify(e);return btoa(t)}catch(e){throw console.error("Failed to convert wallet to base64:",e),e}},getEnvironmentInfo:function(){return{hasEnvVar:"undefined"!=typeof process&&process.env&&!!process.env[WALLET_ENV_VAR],envVarName:WALLET_ENV_VAR}}},t=e;let n,l,a,o,d,s,r,i="",c=0;async function m(){try{l=window.Arweave.init({host:"arweave.net",port:443,protocol:"https"}),await async function(){try{n=await t.getWallet(),i=await l.wallets.jwkToAddress(n);const e=await l.wallets.getBalance(i);return c=l.ar.winstonToAr(e),console.log(`Wallet loaded: ${i.substring(0,8)}... | Balance: ${c} AR`),!0}catch(e){return console.error("Error loading wallet:",e),!1}}(),R()}catch(e){console.error("Initialization error:",e),p("Failed to initialize: "+e.message)}}function V(){console.log("initDomElements called");const e=document.querySelectorAll("*");console.log(`Found ${e.length} elements in document`),a=document.getElementById("uploadButton"),o=document.getElementById("uploadStatus"),d=document.getElementById("ratingForm"),s=document.getElementById("score"),r=document.getElementById("scoreDisplay"),console.log("DOM element references:",{uploadButton:a,ratingForm:d,scoreInput:s,scoreDisplay:r}),console.log("Looking for slider:",document.querySelector('input[type="range"]')),s&&r?(console.log("Slider and display elements found, setting up event listeners"),r.textContent=s.value,r.style.backgroundColor="lightblue",console.log("Set initial display:",s.value),s.addEventListener("input",(function(){console.log("Slider moved to:",this.value),r.textContent=this.value,r.style.backgroundColor="lightgreen"})),s.addEventListener("input",N),console.log("Event listeners added to slider")):(console.error("Slider elements not found!",{scoreInputExists:!!s,scoreDisplayExists:!!r}),setTimeout((()=>{console.log("Trying to find slider elements again after delay..."),s=document.getElementById("score"),r=document.getElementById("scoreDisplay"),s&&r&&(console.log("Found slider elements after delay, setting up..."),s.addEventListener("input",N),N())}),1e3)),d?d.addEventListener("submit",U):console.error("Rating form not found!")}function N(){if(!s||!r)return;r.textContent=s.value;const e=parseInt(s.value);r.className="ml-3 text-xl font-bold px-3 py-1 rounded-full min-w-[3rem] text-center",e>=8?r.classList.add("bg-green-100","text-green-800"):e>=6?r.classList.add("bg-blue-100","text-blue-800"):e>=4?r.classList.add("bg-yellow-100","text-yellow-800"):e>=2?r.classList.add("bg-orange-100","text-orange-800"):r.classList.add("bg-red-100","text-red-800")}function R(){const e=document.createElement("div");e.className="fixed bottom-4 right-4 bg-white shadow-lg rounded-lg p-3 text-sm border border-gray-200",e.innerHTML=n&&i?`\n            <div class="flex items-center text-gray-700">\n                <div class="h-2 w-2 rounded-full bg-green-500 mr-2"></div>\n                <span class="font-medium">System wallet ready</span>\n                <span class="mx-1 text-gray-400">|</span>\n                <span>${c} AR</span>\n            </div>\n        `:'\n            <div class="flex items-center text-red-600">\n                <div class="h-2 w-2 rounded-full bg-red-500 mr-2"></div>\n                <span>System wallet unavailable</span>\n            </div>\n        ',document.body.appendChild(e),setTimeout((()=>{e.style.opacity="0",e.style.transition="opacity 0.5s",setTimeout((()=>e.remove()),500)}),5e3)}async function U(e){if(e.preventDefault(),n)try{a.disabled=!0,a.innerHTML='\n            <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n            </svg>\n            Processing...\n        ',o.innerHTML='\n            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">\n                <div class="flex items-center">\n                    <svg class="animate-pulse h-5 w-5 text-blue-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />\n                    </svg>\n                    <p class="text-sm text-blue-700">Uploading your rating to Arweave...</p>\n                </div>\n            </div>\n        ';const e={firstName:document.getElementById("firstName").value.trim(),middleName:document.getElementById("middleName").value.trim(),lastName:document.getElementById("lastName").value.trim(),location:document.getElementById("location").value.trim(),associations:document.getElementById("associations").value.trim(),score:parseInt(document.getElementById("score").value),comments:document.getElementById("comments").value.trim(),timestamp:Math.floor(Date.now()/1e3)},t=JSON.stringify(e),s=new Blob([t]).size;if(s>51200)throw new Error(`Rating data (${u(s)}) exceeds maximum allowed size (${u(51200)})`);const i=await l.createTransaction({data:t},n);i.addTag("Content-Type","application/json"),i.addTag("App-Name","RateAnybody"),i.addTag("Data-Type","rating"),i.addTag("Unix-Time",String(e.timestamp)),i.addTag("First-Name",e.firstName),i.addTag("Middle-Name",e.middleName),i.addTag("Last-Name",e.lastName),i.addTag("Location",e.location),i.addTag("Associations",e.associations),i.addTag("Rating-Score",String(e.score));const m=l.ar.winstonToAr(i.reward);if(console.log(`Transaction fee: ${m} AR`),parseFloat(c)<parseFloat(m))throw new Error(`Insufficient wallet balance (${c} AR) for transaction fee (${m} AR)`);await l.transactions.sign(i,n);const V=await l.transactions.post(i);if(200!==V.status&&202!==V.status)throw new Error(`Upload failed: ${V.statusText}`);o.innerHTML=`\n                <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">\n                    <div class="flex">\n                        <div class="flex-shrink-0">\n                            <svg class="h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">\n                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />\n                            </svg>\n                        </div>\n                        <div class="ml-3">\n                            <h3 class="text-sm font-medium text-green-800">Rating Submitted Successfully!</h3>\n                            <div class="mt-2 text-sm text-green-700">\n                                <p>Your rating has been permanently stored on the Arweave blockchain.</p>\n                                <p class="mt-2">\n                                    <a href="https://arweave.net/${i.id}" target="_blank" class="font-medium text-green-700 underline">\n                                        View Transaction: ${i.id.substring(0,8)}...${i.id.substring(i.id.length-8)}\n                                    </a>\n                                </p>\n                                <p class="mt-2 text-xs text-green-600">Note: It may take a few minutes for your transaction to be mined.</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `,d.reset(),r&&(r.textContent="5",r.className="ml-3 bg-blue-100 text-blue-800 text-xl font-bold px-3 py-1 rounded-full min-w-[3rem] text-center"),c=(parseFloat(c)-parseFloat(m)).toFixed(6),R()}catch(e){console.error("Error:",e),p(e.message)}finally{a.disabled=!1,a.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">\n                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />\n            </svg>\n            Upload Rating to Arweave\n        '}else p("System wallet is not available. Please try again later or use the Google Form option.")}function p(e){o.innerHTML=`\n        <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">\n            <div class="flex">\n                <div class="flex-shrink-0">\n                    <svg class="h-5 w-5 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">\n                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />\n                    </svg>\n                </div>\n                <div class="ml-3">\n                    <h3 class="text-sm font-medium text-red-800">Error</h3>\n                    <div class="mt-2 text-sm text-red-700">\n                        <p>${e}</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `}function u(e,t=2){if(0===e)return"0 Bytes";const n=t<0?0:t,l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB"][l]}console.log("upload.js script executed at",(new Date).toISOString()),document.addEventListener("DOMContentLoaded",(()=>{console.log("DOMContentLoaded event fired at",(new Date).toISOString());const e=document.getElementById("score"),t=document.getElementById("scoreDisplay");console.log("Direct element check:",{scoreInput:e,scoreDisplay:t}),V(),m().catch((e=>{console.error("Initialization error:",e)}))})),"complete"!==document.readyState&&"interactive"!==document.readyState||(console.log("Document already ready, initializing immediately"),setTimeout((()=>{V(),m().catch((e=>{console.error("Delayed initialization error:",e)}))}),100))})();
//# sourceMappingURL=upload.bundle.js.map